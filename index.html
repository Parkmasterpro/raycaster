<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Lava Is Not Floor! (Insead of ?)</title>
</head>
<body>
	<div id="everything">
	<h1 id="gamelle">Look, Game!</h1>
	<button id="butotn">Play?</button><br>
	<button id="butotn1" onclick="rateGame();">~Rate Game~</button><br>
	<button id="butotn2" onclick="window.close();">DELETE!</button>
	<canvas id="gameing" style="display: none;"></canvas>
	<script>
		/* Get into full screen */
		var goInFullscreen = function(element) {
			if (element.requestFullscreen) {
				element.requestFullscreen();
			} else if(element.mozRequestFullScreen) {
				element.mozRequestFullScreen();
			} else if(element.webkitRequestFullscreen) {
				element.webkitRequestFullscreen();
			} else if(element.msRequestFullscreen) {
				element.msRequestFullscreen()
			}
		};

		/* Get out of full screen */
		var goOutFullscreen = function() {
			if(document.exitFullscreen) {
				document.exitFullscreen();
			} else if(document.mozCancelFullScreen) {
				document.mozCancelFullScreen();
			} else if(document.webkitExitFullscreen) {
				document.webkitExitFullscreen();
			} else if(document.msExitFullscreen) {
				document.msExitFullscreen();
			}
		};

		/* Is currently in full screen or not */
		var isFullScreen = function() {
			var full_screen_element = document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement || null;
			// If no element is in full-screen
			if(full_screen_element === null) {
				return false;
			} else {
				return true;
			}
		};

		let foreverRunning = false;

		const cvs = document.getElementById("gameing"); // Yes that is spelled right
		document.getElementById("butotn").addEventListener("click", function() {
			goInFullscreen(cvs);
			setCanvasInfo();
			if (!foreverRunning) {
				forever();
			}
			foreverRunning = true;
			
		});

		function deletee() {
			document.getElementById('everthing').innerHTML = '<h1>Sry,<br>This Webpage was DELETED<br>:)</h1><h2>Try:</h2><ul><li>Being pro next time</li><li>Not pushing the DELETE button</li><li>Reconnecting to Wi-Fi</li></ul>';
		};

		const ctx = cvs.getContext("2d");

		function rateGame() {
			if (confirm("Is this pro game/website?")) {
				if (confirm("5 stars?")) {
					alert("You are pro!");
					alert("...");
					alert("You are more pro than that guy who gave me 1 star and was banned...");
					alert("Also anybody who gave less than 4 stars");
				} else {
					if (confirm("4 stars?")) {
						if (confirm("Are you sure?")) {
							if (confirm("Are you sure that you're sure?")) {
								alert("I ANGY!");
								window.close();	
							} else {
								alert("Okay good...");
								rateGame();
							}
						} else {
							alert("You are smrt!");
							rateGame();
						}
					} else {
						if (confirm("3 stars?")) {
							alert("<You no pro>");
							alert("I ANGY!");
							window.close();
						} else {
							alert("You are giving me 2 or 1 stars?");
							alert("HOW DARE YOU!");
							alert("I ANGY!")
							alert("...");
							alert("I ban you from this website!");
							window.close();
						}
					}
				}
			} else {
				alert("You cannot play game.");
				alert("U don't know pro...");
				alert("I ban you from this website!");
				window.close();
			}

		};

		function setCanvasInfo() {
			if (!isFullScreen())  {
				cvs.style.display = "none";
			} else {
				cvs.style.display = "block";
			}
			cvs.width = window.innerWidth;
			cvs.height = window.innerHeight;
			screenWidth	= window.innerWidth;
			screenHeight = window.innerHeight;
		};

		let screenWidth;
		let screenHeight;

		let map = [
		{
			x: 0,
			y: 0,
			width: 10,
			height: 110
		},
		{
			x: 100,
			y: 0,
			width: 10,
			height: 110
		},
		{
			x: 0,
			y: 0,
			width: 110,
			height: 10
		},
		{
			x: 0,
			y: 100,
			width: 110,
			height: 10
		},
		{
			x: 25,
			y: 40,
			width: 20,
			height: 45
		}
		];

		function toRadians(degrees) {
			return degrees*(Math.PI/180);
		};

		var player = {
			x: 20,
			y: 20,
			angle: toRadians(90),
			speed: 0.75,
			buttons: {
				arrow: {
					up: false,
					down: false,
					left: false,
					right: false
				},
				wasd: {
					w: false,
					a: false,
					s: false,
					d: false
				}
			},
			move: function(steps) {
				player.tryMove(steps*Math.cos(player.angle), 0);
				player.tryMove(0, steps*Math.sin(player.angle));
			},
			moveLeft: function(steps) {
				player.tryMove(steps*Math.cos(player.angle - toRadians(90)), 0);
				player.tryMove(0, steps*Math.sin(player.angle - toRadians(90)));
			},
			moveRight: function(steps) {
				player.tryMove(steps*Math.cos(player.angle + toRadians(90)), 0);
				player.tryMove(0, steps*Math.sin(player.angle + toRadians(90)));
			},
			//{x: (player.x + x), y: (player.y + y), width: 5, height: 5}
			tryMove: function(px, py) {
				player.x += px;
				player.y += py;
				ctx.fillStyle = "gray";
				for (var i = 0; i < map.length; i++) {
					if (isTouching({x: player.x, y: player.y, width: 5, height: 5}, map[i])) {
						player.x -= px;
						player.y -= py;
						return;
					}
				}
			}
		};


		function isTouching(rect1, rect2) {
			return rect1.x < rect2.x + rect2.width && rect1.x + rect1.width > rect2.x && rect1.y < rect2.y + rect2.height && rect1.y + rect1.height > rect2.y;
		};

		function forever() {
			setCanvasInfo();
			ctx.fillStyle = "black";
			ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);
			game();

			window.requestAnimationFrame(forever);
		};

		// game() = raycaster cod
		function game() {
			playerGoZoom();
			drawLevel(1, (player.x*-1)+(screenWidth/2), (player.y*-1)+(screenHeight/2));
		};


		function drawLevel(scale = 1, xshift = 0, yshift = 0) {
			ctx.fillStyle = "gray";
			
			for (var i = 0; i < map.length; i++) {
				ctx.fillRect(map[i].x*scale+xshift, map[i].y*scale+yshift, map[i].width*scale, map[i].height*scale);
			}
			ctx.fillStyle = "yellow";
			ctx.fillRect(player.x*scale+xshift, player.y*scale+yshift, 5*scale, 5*scale);
			ctx.strokeStyle = "yellow";
			ctx.lineWidth = 2.5*scale;
			ctx.beginPath();
			ctx.moveTo(((player.x+xshift)+2.5)*scale, ((player.y+yshift)+2.5)*scale);
			ctx.lineTo(((player.x+xshift)+2.5)*scale + ((7*scale)*Math.cos(player.angle)), ((player.y+yshift)+2.5)*scale + ((7*scale)*Math.sin(player.angle)));
			ctx.stroke();
		};

		function playerGoZoom() {
			if (player.buttons.arrow.left) {
				player.angle -= toRadians(3);
			} else if (player.buttons.arrow.right) {
				player.angle += toRadians(3);
			}
			if (player.buttons.arrow.up) {
				// Zoom in
			} else if (player.buttons.arrow.down) {
				// Zoom out
			}
			if (player.buttons.wasd.w || player.buttons.arrow.up) {
				player.move(player.speed);
			} else if (player.buttons.wasd.s || player.buttons.arrow.down) {
				player.move(-player.speed);
			}
			if (player.buttons.wasd.a) {
				player.moveLeft(player.speed);
			} else if (player.buttons.wasd.d) {
				player.moveRight(player.speed);
			}
		};

		window.addEventListener("keydown", function(e) {
			if (e.code === "ArrowUp") {
				player.buttons.arrow.up = true;
			} else if (e.code === "ArrowDown") {
				player.buttons.arrow.down = true;
			} else if (e.code === "ArrowLeft") {
				player.buttons.arrow.left = true;
			} else if (e.code === "ArrowRight") {
				player.buttons.arrow.right = true;
			} else if (e.code === "KeyW") {
				player.buttons.wasd.w = true;
			} else if (e.code === "KeyA") {
				player.buttons.wasd.a = true;
			} else if (e.code === "KeyS") {
				player.buttons.wasd.s = true;
			} else if (e.code === "KeyD") {
				player.buttons.wasd.d = true;
			}
		});

		window.addEventListener("keyup", function(e) {
			if (e.code === "ArrowUp") {
				player.buttons.arrow.up = false;
			} else if (e.code === "ArrowDown") {
				player.buttons.arrow.down = false;
			} else if (e.code === "ArrowLeft") {
				player.buttons.arrow.left = false;
			} else if (e.code === "ArrowRight") {
				player.buttons.arrow.right = false;
			} else if (e.code === "KeyW") {
				player.buttons.wasd.w = false;
			} else if (e.code === "KeyA") {
				player.buttons.wasd.a = false;
			} else if (e.code === "KeyS") {
				player.buttons.wasd.s = false;
			} else if (e.code === "KeyD") {
				player.buttons.wasd.d = false;
			}
		});
	</script>
	</div>
</body>
</html>
